<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Parser</title>

  </head>
  <body>
    파일:<input type="file" name="fileExcel" id="fileExcel" >  
    <button id="submit" onclick="excelTableExport()">버튼</button>
    <button id="excelExport" onclick="excelExport()">Excel 다운로드</button>

    

    <div id ="initTableSpot">
      
    </div>
   
        <script>
        // You can also require other files to run in this process
            require('./init.js');
            //require('./excelParser.js');
        

        </script>
  </body>

  
</html>
<script>

  const excelParser = require('./excelParser');
  const utils = require('./util');
  let jsonData ='';
  
  const excelTableExport = () =>{
     
      let files = document.getElementById("fileExcel")
      if(files.files[0]===null || files.files[0] === undefined){
        alert('파일을 넣어주세요')
        return;
      }
      let filepath = files.files[0].path;
      let parserResult=excelParser.excelRead(filepath);
      if(parserResult.flag === false){
        alert(parserResult.msg);
        }else{
          var obj = excelParser.excelWorkseetParser(parserResult);
           utils.tableAdder('initTableSpot',obj);
          jsonData=parserResult;
      }
    };
    const excelExport = () =>{
              jsonData

    };

    


</script>